{
  # Global options
  email admin@olympose.103-110-252-184.sslip.io
}

olympose.103-110-252-184.sslip.io {
  # Automatic HTTPS via Let's Encrypt
  
  # Compression
  encode gzip zstd
  
  # API routes to backend
  handle_path /api/* {
    reverse_proxy ai:8001 {
      header_up Host {host}
      header_up X-Real-IP {remote_host}
      header_up X-Forwarded-For {remote_host}
      header_up X-Forwarded-Proto {scheme}
    }
  }
  
  # All other routes to frontend
  handle {
    reverse_proxy web:3000 {
      header_up Host {host}
      header_up X-Real-IP {remote_host}
      header_up X-Forwarded-For {remote_host}
      header_up X-Forwarded-Proto {scheme}
      
      transport http {
        dial_timeout 10s
        response_header_timeout 30s
      }
    }
  }
  
  # Logging
  log {
    output stdout
    level info
  }
}
